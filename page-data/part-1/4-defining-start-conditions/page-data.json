{"componentChunkName":"component---src-templates-course-content-template-js","path":"/part-1/4-defining-start-conditions","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"exercise","properties":{"name":"youtube-dl image"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"youtube-dl/"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Next, we will start moving towards a more meaningful image. "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"youtube-dl"}]},{"type":"text","value":" is a program that downloads youtube videos "},{"type":"element","tagName":"a","properties":{"href":"https://rg3.github.io/youtube-dl/download.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://rg3.github.io/youtube-dl/download.html"}]},{"type":"text","value":". Let's add it to an image - but this time, we will change our process. Instead of our current process where we add things to the Dockerfile hope it works, let's try another approach. This time we will open up an interactive session and test stuff before \"storing\" it in our Dockerfile."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"docker run -it ubuntu:22.04"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And let's also create a new Dockerfile with the \"same\" content"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And that's it - from the "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"recipe"}]},{"type":"text","value":" point of view this is the only thing we need to persist."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Just train our muscle memory, let's build the image already"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"docker build -t youtube-dl ."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The resulting image is basically the same as "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ubuntu:22.04"}]},{"type":"text","value":", see"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ docker image ls | grep \"22.04\\|youtube-dl\"\n  ubuntu                                     22.04     3c2df5585507   7 days ago       69.2MB\n  youtube-dl                                 latest    adc4f063454b   7 days ago       69.2MB"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Image ID is different, but the size matches."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now by following the youtube-dl install instructions we will see that:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"root@8c587232a608:/# curl -L https://github.com/ytdl-org/youtube-dl/releases/download/2021.12.17/youtube-dl -o /usr/local/bin/youtube-dl\nbash: curl: command not found"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"..and, as we already know, curl is not installed - let's add "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"curl"}]},{"type":"text","value":" with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"apt-get"}]},{"type":"text","value":" again."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"apt-get update && apt-get install -y curl"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And now it's the perfect time to add this to the Dockerfile before we forget to add it, so"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y curl"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then let's use "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"curl"}]},{"type":"text","value":" to fetch the program"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"curl -L https://yt-dl.org/downloads/latest/youtube-dl -o /usr/local/bin/youtube-dl"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"but"}]},{"type":"text","value":" check "},{"type":"element","tagName":"a","properties":{"href":"https://yt-dl.org/downloads/latest/youtube-dl","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://yt-dl.org/downloads/latest/youtube-dl"}]},{"type":"text","value":" and then navigate to "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ytdl-org/youtube-dl/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/ytdl-org/youtube-dl/"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"curl -L https://github.com/ytdl-org/youtube-dl/releases/download/2021.12.17/youtube-dl -o /usr/local/bin/youtube-dl"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"w\nAnd then save the working URL to the Dockerfile"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  curl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You may have noticed that "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" is not installed either, but since we are "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"root"}]},{"type":"text","value":" we don't need it to write to "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/usr/local/bin/"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Next, we will add permissions and run it:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ chmod a+rx /usr/local/bin/youtube-dl\n$ youtube-dl\n  /usr/bin/env: 'python': No such file or directory"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Okay - On the top of the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"youtube-dl"}]},{"type":"text","value":" download page we notice this message:"}]},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Remember youtube-dl requires Python version 2.6, 2.7, or 3.2+ to work except for Windows exe."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So we will add python, but before that let's what we did in the Dockerfile"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  curl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" chmod a+rx /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"docker build -t youtube-dl ."}]},{"type":"text","value":" again and notice how the lines we didn't touch were CACHED (and thus fast)."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now let's add python"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"apt-get install -y python"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And, it fails"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"Reading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nPackage python is not available, but is referred to by another package.\nThis may mean that the package is missing, has been obsoleted, or\nis only available from another source\nHowever the following packages replace it:\n  2to3 python2-minimal python2 dh-python python-is-python3\n\nE: Package 'python' has no installation candidate"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Okay, so... python2 ?"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"apt-get install -y python2"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And let's run it again"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ youtube-dl\n  /usr/bin/env: 'python': No such file or directory"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"...because python2 vs python3 is a mess and now only "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"python2"}]},{"type":"text","value":" command exists. Command "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"youtube-dl"}]},{"type":"text","value":" tries to execute "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"python"}]},{"type":"text","value":" and fails."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"One way to fix this is to:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"update-alternatives --install /usr/bin/python python /usr/bin/python2 1"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And now we can see that"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ python\n  Python 2.7.18 (default, Jul  1 2022, 10:30:50)\n  [GCC 11.2.0] on linux2\n  Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n  >>> exit\n  Use exit() or Ctrl-D (i.e. EOF) to exit\n  >>> exit()"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"works, so "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"youtube-dl"}]},{"type":"text","value":" should work."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It's a good moment to persist what we did"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  curl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" chmod a+rx /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y python2\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" update"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"alternatives "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"install /usr/bin/python python /usr/bin/python2 1"}]}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ youtube-dl\nWARNING: Assuming --restrict-filenames since file system encoding cannot encode all characters. Set the LC_ALL environment variable to fix this.\nUsage: youtube-dl [OPTIONS] URL [URL...]\n\nyoutube-dl: error: You must provide at least one URL.\nType youtube-dl --help to see a list of all options."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It works (we just need to give an URL), but we notice that it outputs a warning about "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"LC_ALL"}]},{"type":"text","value":". In a regular Ubuntu desktop/server install the localization settings are (usually) set, but in this image they are not set, as we can see by running "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"env"}]},{"type":"text","value":" in our container. To fix this without installing additional locales, see this: "},{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/a/41648500","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://stackoverflow.com/a/41648500"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"LC_ALL=C.UTF-8 youtube-dl"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And it works! Let's persist it for our session and try downloading a video:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"export LC_ALL=C.UTF-8\nyoutube-dl https://imgur.com/JY5tHqr"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So now when we know exactly what we need to build a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"youtube-dl"}]},{"type":"text","value":" container on top of "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ubuntu:22.04"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The videos are downloaded in to the current working directory, which by default is "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/"}]},{"type":"text","value":". We can change this in the Dockerfile with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"text","value":" directive."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And instead of using "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"RUN export LC_ALL=C.UTF-8"}]},{"type":"text","value":" we store the environment directly in the image with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ENV"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lastly we override the default "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CMD"}]},{"type":"text","value":" from "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"bash"}]},{"type":"text","value":" to "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"youtube-dl"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  curl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" chmod a+rx /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  python2\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" update"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"alternatives "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"install /usr/bin/python python /usr/bin/python2 1\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENV"}]},{"type":"text","value":" LC_ALL=C.UTF"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"8\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"text","value":" /app\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"CMD"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"/usr/local/bin/youtube-dl\""}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When we build this ..."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ docker build -t youtube-dl .\n  ..."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"... and run it"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ docker run youtube-dl\n  Usage: youtube-dl [OPTIONS] URL [URL...]\n\n  youtube-dl: error: You must provide at least one URL.\n  Type youtube-dl --help to see a list of all options."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So far so good, but now the natural way to use this image would be to give the URL as an argument:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ docker run youtube-dl https://imgur.com/JY5tHqr\n\n  docker: Error response from daemon: failed to create shim: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: \"https://imgur.com/JY5tHqr\": stat https://imgur.com/JY5tHqr: no such file or directory: unknown.\n  ERRO[0000] error waiting for container: context canceled"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As we now know, the argument we gave it is replacing the command or "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CMD"}]},{"type":"text","value":". We need a way to have something "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"before"}]},{"type":"text","value":" the command. Luckily we have a way to do this: we can use "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" to define the main executable and then docker will combine our run arguments for it."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"text","value":" /app\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y curl python2\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" chmod a+x /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" update"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"alternatives "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"install /usr/bin/python python /usr/bin/python2 1\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENV"}]},{"type":"text","value":" LC_ALL=C.UTF"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"8\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Replacing CMD with ENTRYPOINT - these extra [ ] are explained later"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"/usr/local/bin/youtube-dl\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And now it works like it should:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ docker build -t youtube-dl .\n$ docker run youtube-dl https://imgur.com/JY5tHqr\n\n  [Imgur] JY5tHqr: Downloading webpage\n  [download] Destination: Imgur-JY5tHqr.mp4\n  [download] 100% of 190.20KiB in 00:0044MiB/s ETA 00:000"}]}]}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"CMD vs ENTRYPOINT"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"docker run"}]},{"type":"text","value":" now executed the combined "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/usr/local/bin/youtube-dl https://imgur.com/JY5tHqr"}]},{"type":"text","value":" inside the container with that command!"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" vs "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CMD"}]},{"type":"text","value":" is confusing - in a properly set up image such as our youtube-dl the command represents an argument list for the entrypoint. By default entrypoint is set as "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/bin/bash"}]},{"type":"text","value":" and this is passed if no entrypoint is set. This is why giving path to a script file as CMD works: you're giving the file as a parameter to "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/bin/bash"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In addition, there are two ways to set them: "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"exec"}]},{"type":"text","value":" form and "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"shell"}]},{"type":"text","value":" form. We've been using the exec form where the command itself is executed. In shell form the command that is executed is wrapped with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/bin/sh -c"}]},{"type":"text","value":" - it's useful when you need to evaluate environment variables in the command like "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"$MYSQL_PASSWORD"}]},{"type":"text","value":" or similar."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the shell form the command is provided as a string without brackets. In the exec form the command and it's arguments are provided as a list (with brackets), see the table below:"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Dockerfile"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"Resulting command"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"ENTRYPOINT /bin/ping -c 3 "},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":" CMD localhost"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"/bin/sh -c '/bin/ping -c 3' /bin/sh -c localhost"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"ENTRYPOINT [\"/bin/ping\",\"-c\",\"3\"] "},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":" CMD localhost"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"/bin/ping -c 3 /bin/sh -c localhost"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"ENTRYPOINT /bin/ping -c 3 "},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":" CMD [\"localhost\"]"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"/bin/sh -c '/bin/ping -c 3' localhost"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"ENTRYPOINT [\"/bin/ping\",\"-c\",\"3\"] "},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":" CMD [\"localhost\"]"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"/bin/ping -c 3 localhost"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As the command at the end of docker run will be the CMD we want to use ENTRYPOINT to specify what to run, and CMD to specify which command (in our case url) to run."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Most of the time"}]},{"type":"text","value":" we can ignore ENTRYPOINT when building our images and only use CMD. For example, ubuntu image defaults the ENTRYPOINT to bash so we do not have to worry about it. And it gives us the convenience of allowing us to overwrite the CMD easily, for example, with bash to go inside the container."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"docker cp"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now we have two problems with the youtube-dl project:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Major: The downloaded files stay in the container"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Minor: Our container build process creates many layers resulting in increased image size"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We will fix the major issue first. The minor issue will get our attention in part 3."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"By inspecting "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"docker container ls -a"}]},{"type":"text","value":" we can see all our previous runs. When we filter this list with"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ docker container ls -a --last 3\n\n  CONTAINER ID        IMAGE               COMMAND                   CREATED                  STATUS                          PORTS               NAMES\n  be9fdbcafb23        youtube-dl          \"/usr/local/bin/yout…\"    Less than a second ago   Exited (0) About a minute ago                       determined_elion\n  b61e4029f997        f2210c2591a1        \"/bin/sh -c \\\"/usr/lo…\"   Less than a second ago   Exited (2) About a minute ago                       vigorous_bardeen\n  326bb4f5af1e        f2210c2591a1        \"/bin/sh -c \\\"/usr/lo…\"   About a minute ago       Exited (2) 3 minutes ago                            hardcore_carson"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We see that the last container was "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"be9fdbcafb23"}]},{"type":"text","value":" or "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"determined_elion"}]},{"type":"text","value":" for us humans."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ docker diff determined_elion\n\n  C /app\n  A /app/Imgur-JY5tHqr.mp4"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let's try "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"docker cp"}]},{"type":"text","value":" command to copy the file. We can use quotes if the filename has spaces."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"docker cp \"determined_elion://app/Imgur-JY5tHqr.mp4\" ."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And now we have our file locally. Sadly, this is not sufficient to fix our issue. In the next section, we will improve this.."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"Dockerfile optimize"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"..but before that, let's optimize the dockerfile:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENV"}]},{"type":"text","value":" LC_ALL=C.UTF"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"8\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" set "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"eux ; \\\n  apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update ; \\\n  apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y curl python2 \\\n  update"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"alternatives "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"install /usr/bin/python python /usr/bin/python2 1\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" set "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"eux ; \\\n  curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl ; \\\n  chmod a+rx /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"text","value":" /app\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"/usr/local/bin/youtube-dl\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Test with "},{"type":"element","tagName":"a","properties":{"href":"https://www.fromlatest.io","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://www.fromlatest.io"}]},{"type":"text","value":" —> no issues!"}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"optimizations"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Sometimes you'll see all kinds of apt cache removals like "},{"type":"element","tagName":"a","properties":{"href":"https://gist.github.com/marvell/7c812736565928e602c4","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://gist.github.com/marvell/7c812736565928e602c4"}]},{"type":"text","value":". This is no longer needed, nowadays official Debian/ubuntu images "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/moby/moby/blob/03e2923e42446dbb830c654d0eec323a0b4ef02a/contrib/mkimage/debootstrap#L82-L105","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"automatically run apt-cache"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You might want to consider "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"--no-install-recommends"}]},{"type":"text","value":", let's test it"}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"multi-stage"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://docs.docker.com/build/building/multi-stage/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://docs.docker.com/build/building/multi-stage/"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04 as builder\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  curl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl \\\n  && chmod a+rx /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENV"}]},{"type":"text","value":" LC_ALL=C.UTF"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"8\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  python2 ca"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"certificates \\\n  && update"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"alternatives "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"install /usr/bin/python python /usr/bin/python2 1\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"COPY"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"from=builder /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl /usr/local/bin\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"text","value":" /app\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"/usr/local/bin/youtube-dl\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]}]}]}]},{"type":"element","tagName":"h2","properties":{"id":"picknmix","style":"position:relative;"},"children":[{"type":"text","value":"pick'n'mix"},{"type":"element","tagName":"a","properties":{"href":"#picknmix","ariaLabel":"picknmix permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Combine ubuntu and alpine"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04 as builder\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update && apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y \\\n  curl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" curl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"L https"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"//github.com/ytdl"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"org/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl/releases/download/2021.12.17/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl \\\n  && chmod a+rx /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl\n\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" alpine"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"latest\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENV"}]},{"type":"text","value":" LC_ALL=C.UTF"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"8\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apk add python3\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"COPY"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"from=builder /usr/local/bin/youtube"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dl /usr/local/bin\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"text","value":" /app\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"/usr/local/bin/youtube-dl\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]}]}]}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"curler entrypoint"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" we can make the curler more flexible."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"curler/curler.sh"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","shebang","important"]},"children":[{"type":"text","value":"#!/bin/bash"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"echo"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"Searching..\""}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sleep"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"curl"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"http://"},{"type":"element","tagName":"span","properties":{"className":["token","variable"]},"children":[{"type":"text","value":"$1"}]},{"type":"text","value":"\""}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And change the CMD to ENTRYPOINT with the format "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"[ \"/app/curler.sh\" ]"}]},{"type":"text","value":":"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"curler/Dockerfile"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"dockerfile"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-dockerfile"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"FROM"}]},{"type":"text","value":" ubuntu"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"22.04\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get update\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" apt"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"get install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"y curl\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"text","value":" /app\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"COPY"}]},{"type":"text","value":" curler.sh .\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"RUN"}]},{"type":"text","value":" chmod +x curler.sh\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"ENTRYPOINT"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"/app/curler.sh\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"$ docker build "},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":" -t curler-v2\n$ docker run curler-v2 helsinki.fi\n\n  Searching"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":".."}]},{"type":"text","value":"\n    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                   Dload  Upload   Total   Spent    Left  Speed\n  "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"100"}]},{"type":"text","value":"   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"232"}]},{"type":"text","value":"  "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"100"}]},{"type":"text","value":"   "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"232"}]},{"type":"text","value":"    "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"     "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":"  "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"13647"}]},{"type":"text","value":"      "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"text","value":" --:--:-- --:--:-- --:--:-- "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"13647"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"!"}]},{"type":"text","value":"DOCTYPE HTML PUBLIC "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"-//IETF//DTD HTML 2.0//EN\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"html"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"head"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"title"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"301"}]},{"type":"text","value":" Moved Permanently"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"/title"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"/head"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"body"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"h"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","file-descriptor","important"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":">"}]},{"type":"text","value":"Moved Permanently"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"/h"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","file-descriptor","important"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":">"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"p"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"The document has moved "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"a "},{"type":"element","tagName":"span","properties":{"className":["token","assign-left","variable"]},"children":[{"type":"text","value":"href"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"https://www.helsinki.fi/\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"here"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"/a"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"."},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"/p"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"/body"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"/html"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]}]}]}]}]}]},"html":"<div><exercise name='youtube-dl image'><p><strong>youtube-dl/</strong></p><p>Next, we will start moving towards a more meaningful image. <em>youtube-dl</em> is a program that downloads youtube videos <a href=\"https://rg3.github.io/youtube-dl/download.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://rg3.github.io/youtube-dl/download.html</a>. Let's add it to an image - but this time, we will change our process. Instead of our current process where we add things to the Dockerfile hope it works, let's try another approach. This time we will open up an interactive session and test stuff before \"storing\" it in our Dockerfile.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">docker run -it ubuntu:22.04</code></pre></div><p>And let's also create a new Dockerfile with the \"same\" content</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04</code></pre></div><p>And that's it - from the <em>recipe</em> point of view this is the only thing we need to persist.</p><p>Just train our muscle memory, let's build the image already</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">docker build -t youtube-dl .</code></pre></div><p>The resulting image is basically the same as <code class=\"language-text\">ubuntu:22.04</code>, see</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ docker image ls | grep &quot;22.04\\|youtube-dl&quot;\n  ubuntu                                     22.04     3c2df5585507   7 days ago       69.2MB\n  youtube-dl                                 latest    adc4f063454b   7 days ago       69.2MB</code></pre></div><p>Image ID is different, but the size matches.</p><p>Now by following the youtube-dl install instructions we will see that:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">root@8c587232a608:/# curl -L https://github.com/ytdl-org/youtube-dl/releases/download/2021.12.17/youtube-dl -o /usr/local/bin/youtube-dl\nbash: curl: command not found</code></pre></div><p>..and, as we already know, curl is not installed - let's add <code class=\"language-text\">curl</code> with <code class=\"language-text\">apt-get</code> again.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">apt-get update &amp;&amp; apt-get install -y curl</code></pre></div><p>And now it's the perfect time to add this to the Dockerfile before we forget to add it, so</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y curl</code></pre></div><p>Then let's use <code class=\"language-text\">curl</code> to fetch the program</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">curl -L https://yt-dl.org/downloads/latest/youtube-dl -o /usr/local/bin/youtube-dl</code></pre></div><p><em>but</em> check <a href=\"https://yt-dl.org/downloads/latest/youtube-dl\" target=\"_blank\" rel=\"noopener noreferrer\">https://yt-dl.org/downloads/latest/youtube-dl</a> and then navigate to <a href=\"https://github.com/ytdl-org/youtube-dl/\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/ytdl-org/youtube-dl/</a></p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">curl -L https://github.com/ytdl-org/youtube-dl/releases/download/2021.12.17/youtube-dl -o /usr/local/bin/youtube-dl</code></pre></div><p>w\nAnd then save the working URL to the Dockerfile</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  curl\n\n<span class=\"token keyword\">RUN</span> curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl</code></pre></div><p>You may have noticed that <em>sudo</em> is not installed either, but since we are <em>root</em> we don't need it to write to <code class=\"language-text\">/usr/local/bin/</code></p><p>Next, we will add permissions and run it:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ chmod a+rx /usr/local/bin/youtube-dl\n$ youtube-dl\n  /usr/bin/env: &#39;python&#39;: No such file or directory</code></pre></div><p>Okay - On the top of the <code class=\"language-text\">youtube-dl</code> download page we notice this message:</p><blockquote>\n<p>Remember youtube-dl requires Python version 2.6, 2.7, or 3.2+ to work except for Windows exe.</p>\n</blockquote><p>So we will add python, but before that let's what we did in the Dockerfile</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  curl\n\n<span class=\"token keyword\">RUN</span> curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n<span class=\"token keyword\">RUN</span> chmod a+rx /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl</code></pre></div><p>Then <code class=\"language-text\">docker build -t youtube-dl .</code> again and notice how the lines we didn't touch were CACHED (and thus fast).</p><p>Now let's add python</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">apt-get install -y python</code></pre></div><p>And, it fails</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">Reading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nPackage python is not available, but is referred to by another package.\nThis may mean that the package is missing, has been obsoleted, or\nis only available from another source\nHowever the following packages replace it:\n  2to3 python2-minimal python2 dh-python python-is-python3\n\nE: Package &#39;python&#39; has no installation candidate</code></pre></div><p>Okay, so... python2 ?</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">apt-get install -y python2</code></pre></div><p>And let's run it again</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ youtube-dl\n  /usr/bin/env: &#39;python&#39;: No such file or directory</code></pre></div><p>...because python2 vs python3 is a mess and now only <code class=\"language-text\">python2</code> command exists. Command <code class=\"language-text\">youtube-dl</code> tries to execute <code class=\"language-text\">python</code> and fails.</p><p>One way to fix this is to:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">update-alternatives --install /usr/bin/python python /usr/bin/python2 1</code></pre></div><p>And now we can see that</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ python\n  Python 2.7.18 (default, Jul  1 2022, 10:30:50)\n  [GCC 11.2.0] on linux2\n  Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.\n  &gt;&gt;&gt; exit\n  Use exit() or Ctrl-D (i.e. EOF) to exit\n  &gt;&gt;&gt; exit()</code></pre></div><p>works, so <code class=\"language-text\">youtube-dl</code> should work.</p><p>It's a good moment to persist what we did</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  curl\n\n<span class=\"token keyword\">RUN</span> curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n<span class=\"token keyword\">RUN</span> chmod a+rx /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y python2\n<span class=\"token keyword\">RUN</span> update<span class=\"token punctuation\">-</span>alternatives <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>install /usr/bin/python python /usr/bin/python2 1</code></pre></div><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ youtube-dl\nWARNING: Assuming --restrict-filenames since file system encoding cannot encode all characters. Set the LC_ALL environment variable to fix this.\nUsage: youtube-dl [OPTIONS] URL [URL...]\n\nyoutube-dl: error: You must provide at least one URL.\nType youtube-dl --help to see a list of all options.</code></pre></div><p>It works (we just need to give an URL), but we notice that it outputs a warning about <code class=\"language-text\">LC_ALL</code>. In a regular Ubuntu desktop/server install the localization settings are (usually) set, but in this image they are not set, as we can see by running <code class=\"language-text\">env</code> in our container. To fix this without installing additional locales, see this: <a href=\"https://stackoverflow.com/a/41648500\" target=\"_blank\" rel=\"noopener noreferrer\">https://stackoverflow.com/a/41648500</a></p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">LC_ALL=C.UTF-8 youtube-dl</code></pre></div><p>And it works! Let's persist it for our session and try downloading a video:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">export LC_ALL=C.UTF-8\nyoutube-dl https://imgur.com/JY5tHqr</code></pre></div><p>So now when we know exactly what we need to build a <code class=\"language-text\">youtube-dl</code> container on top of <code class=\"language-text\">ubuntu:22.04</code></p><p>The videos are downloaded in to the current working directory, which by default is <code class=\"language-text\">/</code>. We can change this in the Dockerfile with <code class=\"language-text\">WORKDIR</code> directive.</p><p>And instead of using <code class=\"language-text\">RUN export LC_ALL=C.UTF-8</code> we store the environment directly in the image with <code class=\"language-text\">ENV</code></p><p>Lastly we override the default <code class=\"language-text\">CMD</code> from <code class=\"language-text\">bash</code> to <code class=\"language-text\">youtube-dl</code></p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  curl\n\n<span class=\"token keyword\">RUN</span> curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n<span class=\"token keyword\">RUN</span> chmod a+rx /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  python2\n\n<span class=\"token keyword\">RUN</span> update<span class=\"token punctuation\">-</span>alternatives <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>install /usr/bin/python python /usr/bin/python2 1\n\n<span class=\"token keyword\">ENV</span> LC_ALL=C.UTF<span class=\"token punctuation\">-</span>8\n\n<span class=\"token keyword\">WORKDIR</span> /app\n\n<span class=\"token keyword\">CMD</span> <span class=\"token string\">\"/usr/local/bin/youtube-dl\"</span></code></pre></div><p>When we build this ...</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ docker build -t youtube-dl .\n  ...</code></pre></div><p>... and run it</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ docker run youtube-dl\n  Usage: youtube-dl [OPTIONS] URL [URL...]\n\n  youtube-dl: error: You must provide at least one URL.\n  Type youtube-dl --help to see a list of all options.</code></pre></div><p>So far so good, but now the natural way to use this image would be to give the URL as an argument:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ docker run youtube-dl https://imgur.com/JY5tHqr\n\n  docker: Error response from daemon: failed to create shim: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: &quot;https://imgur.com/JY5tHqr&quot;: stat https://imgur.com/JY5tHqr: no such file or directory: unknown.\n  ERRO[0000] error waiting for container: context canceled</code></pre></div><p>As we now know, the argument we gave it is replacing the command or <code class=\"language-text\">CMD</code>. We need a way to have something <em>before</em> the command. Luckily we have a way to do this: we can use <code class=\"language-text\">ENTRYPOINT</code> to define the main executable and then docker will combine our run arguments for it.</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n\n<span class=\"token keyword\">WORKDIR</span> /app\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y curl python2\n<span class=\"token keyword\">RUN</span> curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n<span class=\"token keyword\">RUN</span> chmod a+x /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n<span class=\"token keyword\">RUN</span> update<span class=\"token punctuation\">-</span>alternatives <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>install /usr/bin/python python /usr/bin/python2 1\n\n<span class=\"token keyword\">ENV</span> LC_ALL=C.UTF<span class=\"token punctuation\">-</span>8\n\n<span class=\"token comment\"># Replacing CMD with ENTRYPOINT - these extra [ ] are explained later</span>\n<span class=\"token keyword\">ENTRYPOINT</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/usr/local/bin/youtube-dl\"</span><span class=\"token punctuation\">]</span></code></pre></div><p>And now it works like it should:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ docker build -t youtube-dl .\n$ docker run youtube-dl https://imgur.com/JY5tHqr\n\n  [Imgur] JY5tHqr: Downloading webpage\n  [download] Destination: Imgur-JY5tHqr.mp4\n  [download] 100% of 190.20KiB in 00:0044MiB/s ETA 00:000</code></pre></div></exercise><text-box variant='learningObjectives' name='CMD vs ENTRYPOINT'><p>With <em>ENTRYPOINT</em> <code class=\"language-text\">docker run</code> now executed the combined <code class=\"language-text\">/usr/local/bin/youtube-dl https://imgur.com/JY5tHqr</code> inside the container with that command!</p><p><code class=\"language-text\">ENTRYPOINT</code> vs <code class=\"language-text\">CMD</code> is confusing - in a properly set up image such as our youtube-dl the command represents an argument list for the entrypoint. By default entrypoint is set as <code class=\"language-text\">/bin/bash</code> and this is passed if no entrypoint is set. This is why giving path to a script file as CMD works: you're giving the file as a parameter to <code class=\"language-text\">/bin/bash</code>.</p><p>In addition, there are two ways to set them: <strong>exec</strong> form and <strong>shell</strong> form. We've been using the exec form where the command itself is executed. In shell form the command that is executed is wrapped with <code class=\"language-text\">/bin/sh -c</code> - it's useful when you need to evaluate environment variables in the command like <code class=\"language-text\">$MYSQL_PASSWORD</code> or similar.</p><p>In the shell form the command is provided as a string without brackets. In the exec form the command and it's arguments are provided as a list (with brackets), see the table below:</p><table>\n<thead>\n<tr>\n<th>Dockerfile</th>\n<th>Resulting command</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ENTRYPOINT /bin/ping -c 3 <br> CMD localhost</td>\n<td>/bin/sh -c '/bin/ping -c 3' /bin/sh -c localhost</td>\n</tr>\n<tr>\n<td>ENTRYPOINT [\"/bin/ping\",\"-c\",\"3\"] <br> CMD localhost</td>\n<td>/bin/ping -c 3 /bin/sh -c localhost</td>\n</tr>\n<tr>\n<td>ENTRYPOINT /bin/ping -c 3 <br> CMD [\"localhost\"]</td>\n<td>/bin/sh -c '/bin/ping -c 3' localhost</td>\n</tr>\n<tr>\n<td>ENTRYPOINT [\"/bin/ping\",\"-c\",\"3\"] <br> CMD [\"localhost\"]</td>\n<td>/bin/ping -c 3 localhost</td>\n</tr>\n</tbody>\n</table><p>As the command at the end of docker run will be the CMD we want to use ENTRYPOINT to specify what to run, and CMD to specify which command (in our case url) to run.</p><p><strong>Most of the time</strong> we can ignore ENTRYPOINT when building our images and only use CMD. For example, ubuntu image defaults the ENTRYPOINT to bash so we do not have to worry about it. And it gives us the convenience of allowing us to overwrite the CMD easily, for example, with bash to go inside the container.</p></text-box><exercise name='docker cp'><p>Now we have two problems with the youtube-dl project:</p><ul>\n<li>\n<p>Major: The downloaded files stay in the container</p>\n</li>\n<li>\n<p>Minor: Our container build process creates many layers resulting in increased image size</p>\n</li>\n</ul><p>We will fix the major issue first. The minor issue will get our attention in part 3.</p><p>By inspecting <code class=\"language-text\">docker container ls -a</code> we can see all our previous runs. When we filter this list with</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ docker container ls -a --last 3\n\n  CONTAINER ID        IMAGE               COMMAND                   CREATED                  STATUS                          PORTS               NAMES\n  be9fdbcafb23        youtube-dl          &quot;/usr/local/bin/yout…&quot;    Less than a second ago   Exited (0) About a minute ago                       determined_elion\n  b61e4029f997        f2210c2591a1        &quot;/bin/sh -c \\&quot;/usr/lo…&quot;   Less than a second ago   Exited (2) About a minute ago                       vigorous_bardeen\n  326bb4f5af1e        f2210c2591a1        &quot;/bin/sh -c \\&quot;/usr/lo…&quot;   About a minute ago       Exited (2) 3 minutes ago                            hardcore_carson</code></pre></div><p>We see that the last container was <code class=\"language-text\">be9fdbcafb23</code> or <code class=\"language-text\">determined_elion</code> for us humans.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ docker diff determined_elion\n\n  C /app\n  A /app/Imgur-JY5tHqr.mp4</code></pre></div><p>Let's try <code class=\"language-text\">docker cp</code> command to copy the file. We can use quotes if the filename has spaces.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">docker cp &quot;determined_elion://app/Imgur-JY5tHqr.mp4&quot; .</code></pre></div><p>And now we have our file locally. Sadly, this is not sufficient to fix our issue. In the next section, we will improve this..</p></exercise><exercise name='Dockerfile optimize'><p>..but before that, let's optimize the dockerfile:</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n<span class=\"token keyword\">ENV</span> LC_ALL=C.UTF<span class=\"token punctuation\">-</span>8\n\n<span class=\"token keyword\">RUN</span> set <span class=\"token punctuation\">-</span>eux ; \\\n  apt<span class=\"token punctuation\">-</span>get update ; \\\n  apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y curl python2 \\\n  update<span class=\"token punctuation\">-</span>alternatives <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>install /usr/bin/python python /usr/bin/python2 1\n\n<span class=\"token keyword\">RUN</span> set <span class=\"token punctuation\">-</span>eux ; \\\n  curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl ; \\\n  chmod a+rx /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n<span class=\"token keyword\">WORKDIR</span> /app\n<span class=\"token keyword\">ENTRYPOINT</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/usr/local/bin/youtube-dl\"</span><span class=\"token punctuation\">]</span></code></pre></div><p>Test with <a href=\"https://www.fromlatest.io\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.fromlatest.io</a> —> no issues!</p></exercise><text-box variant='learningObjectives' name='optimizations'><p>Sometimes you'll see all kinds of apt cache removals like <a href=\"https://gist.github.com/marvell/7c812736565928e602c4\" target=\"_blank\" rel=\"noopener noreferrer\">https://gist.github.com/marvell/7c812736565928e602c4</a>. This is no longer needed, nowadays official Debian/ubuntu images <a href=\"https://github.com/moby/moby/blob/03e2923e42446dbb830c654d0eec323a0b4ef02a/contrib/mkimage/debootstrap#L82-L105\" target=\"_blank\" rel=\"noopener noreferrer\">automatically run apt-cache</a></p><p>You might want to consider <code class=\"language-text\">--no-install-recommends</code>, let's test it</p></text-box><text-box variant='learningObjectives' name='multi-stage'><p><a href=\"https://docs.docker.com/build/building/multi-stage/\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.docker.com/build/building/multi-stage/</a></p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04 as builder\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  curl\n\n<span class=\"token keyword\">RUN</span> curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl \\\n  &amp;&amp; chmod a+rx /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n<span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n<span class=\"token keyword\">ENV</span> LC_ALL=C.UTF<span class=\"token punctuation\">-</span>8\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  python2 ca<span class=\"token punctuation\">-</span>certificates \\\n  &amp;&amp; update<span class=\"token punctuation\">-</span>alternatives <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>install /usr/bin/python python /usr/bin/python2 1\n\n<span class=\"token keyword\">COPY</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>from=builder /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl /usr/local/bin\n\n<span class=\"token keyword\">WORKDIR</span> /app\n<span class=\"token keyword\">ENTRYPOINT</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/usr/local/bin/youtube-dl\"</span><span class=\"token punctuation\">]</span></code></pre></div><h2 id=\"picknmix\" style=\"position:relative;\">pick'n'mix<a href=\"#picknmix\" aria-label=\"picknmix permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Combine ubuntu and alpine</p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04 as builder\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update &amp;&amp; apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y \\\n  curl\n\n<span class=\"token keyword\">RUN</span> curl <span class=\"token punctuation\">-</span>L https<span class=\"token punctuation\">:</span>//github.com/ytdl<span class=\"token punctuation\">-</span>org/youtube<span class=\"token punctuation\">-</span>dl/releases/download/2021.12.17/youtube<span class=\"token punctuation\">-</span>dl <span class=\"token punctuation\">-</span>o /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl \\\n  &amp;&amp; chmod a+rx /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl\n\n\n<span class=\"token keyword\">FROM</span> alpine<span class=\"token punctuation\">:</span>latest\n<span class=\"token keyword\">ENV</span> LC_ALL=C.UTF<span class=\"token punctuation\">-</span>8\n\n<span class=\"token keyword\">RUN</span> apk add python3\n\n<span class=\"token keyword\">COPY</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>from=builder /usr/local/bin/youtube<span class=\"token punctuation\">-</span>dl /usr/local/bin\n\n<span class=\"token keyword\">WORKDIR</span> /app\n<span class=\"token keyword\">ENTRYPOINT</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/usr/local/bin/youtube-dl\"</span><span class=\"token punctuation\">]</span></code></pre></div></text-box><text-box variant='learningObjectives' name='curler entrypoint'><p>With <code class=\"language-text\">ENTRYPOINT</code> we can make the curler more flexible.</p><p><strong>curler/curler.sh</strong></p><div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Searching..\"</span>\n<span class=\"token function\">sleep</span> <span class=\"token number\">1</span>\n<span class=\"token function\">curl</span> <span class=\"token string\">\"http://<span class=\"token variable\">$1</span>\"</span></code></pre></div><p>And change the CMD to ENTRYPOINT with the format <code class=\"language-text\">[ &quot;/app/curler.sh&quot; ]</code>:</p><p><strong>curler/Dockerfile</strong></p><div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> ubuntu<span class=\"token punctuation\">:</span>22.04\n\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get update\n<span class=\"token keyword\">RUN</span> apt<span class=\"token punctuation\">-</span>get install <span class=\"token punctuation\">-</span>y curl\n\n<span class=\"token keyword\">WORKDIR</span> /app\n<span class=\"token keyword\">COPY</span> curler.sh .\n\n<span class=\"token keyword\">RUN</span> chmod +x curler.sh\n\n<span class=\"token keyword\">ENTRYPOINT</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/app/curler.sh\"</span><span class=\"token punctuation\">]</span></code></pre></div><p>Now</p><div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker build <span class=\"token builtin class-name\">.</span> -t curler-v2\n$ docker run curler-v2 helsinki.fi\n\n  Searching<span class=\"token punctuation\">..</span>\n    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                   Dload  Upload   Total   Spent    Left  Speed\n  <span class=\"token number\">100</span>   <span class=\"token number\">232</span>  <span class=\"token number\">100</span>   <span class=\"token number\">232</span>    <span class=\"token number\">0</span>     <span class=\"token number\">0</span>  <span class=\"token number\">13647</span>      <span class=\"token number\">0</span> --:--:-- --:--:-- --:--:-- <span class=\"token number\">13647</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>DOCTYPE HTML PUBLIC <span class=\"token string\">\"-//IETF//DTD HTML 2.0//EN\"</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span><span class=\"token number\">301</span> Moved Permanently<span class=\"token operator\">&lt;</span>/title<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/head<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>h<span class=\"token operator\"><span class=\"token file-descriptor important\">1</span>></span>Moved Permanently<span class=\"token operator\">&lt;</span>/h<span class=\"token operator\"><span class=\"token file-descriptor important\">1</span>></span>\n  <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>The document has moved <span class=\"token operator\">&lt;</span>a <span class=\"token assign-left variable\">href</span><span class=\"token operator\">=</span><span class=\"token string\">\"https://www.helsinki.fi/\"</span><span class=\"token operator\">></span>here<span class=\"token operator\">&lt;</span>/a<span class=\"token operator\">></span>.<span class=\"token operator\">&lt;</span>/p<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/body<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>/html<span class=\"token operator\">></span></code></pre></div></text-box></div>","frontmatter":{"path":"/part-1/4-defining-start-conditions","title":"Defining start conditions for the container"},"fileAbsolutePath":"/Users/mpa/dev/docker-hy/data/part-1/section-4.md"},"allPages":{"edges":[{"node":{"id":"948f83e9-b338-5b95-ae2d-a7c680eadb0c","frontmatter":{"path":"/frontmatter-guide","title":"Frontmatter-guide"}}},{"node":{"id":"fe138126-ea55-51b2-a071-8a7532aa51af","frontmatter":{"path":"/part-2","title":"Part 2"}}},{"node":{"id":"8147ba2c-1cbf-5878-b301-ef847e624e70","frontmatter":{"path":"/part-3/2-development","title":"Development with Docker"}}},{"node":{"id":"ed0e0aae-16de-5de9-8877-77337c24124f","frontmatter":{"path":"/part-3","title":"Part 3"}}},{"node":{"id":"1b7ed2f7-c954-577b-ac8d-cae5f2dfc838","frontmatter":{"path":"/part-2/2-docker-networking","title":"More Docker networking"}}},{"node":{"id":"3a0a776d-ec13-50e5-ade2-6c0d549f58ba","frontmatter":{"path":"/part-1","title":"Part 1"}}},{"node":{"id":"ad6b1fb2-b897-54c5-8ce5-00acf0c99caf","frontmatter":{"path":"/part-2/3-wordpress","title":"Wordpress"}}},{"node":{"id":"cea7278b-6d74-539e-b105-29dc780024b6","frontmatter":{"path":"/part-1/2-running-and-stopping","title":"Running and stopping containers"}}},{"node":{"id":"83f82958-678d-500e-8ce0-a2d587fed9c1","frontmatter":{"path":"/part-1/3-in-depth-dive-to-images","title":"In-depth dive to images"}}},{"node":{"id":"087c95a9-00b7-523d-bc13-85d227b71193","frontmatter":{"path":"/part-1/7-summary","title":"Summary"}}},{"node":{"id":"d3b909df-cb77-59a6-8402-f961bd2a7aff","frontmatter":{"path":"/part-1/5-volumes-and-ports","title":"Interacting with the container via volumes and ports"}}},{"node":{"id":"e8a51e48-cc89-5f08-8c00-2c3abe47d5a9","frontmatter":{"path":"/","title":"About this course"}}},{"node":{"id":"455aef79-d091-56bd-bace-e566c89238bb","frontmatter":{"path":"/part-1/1-getting-started","title":"Definitions and basic concepts"}}},{"node":{"id":"2b806816-8c59-5a3a-9b89-da8548d44e0a","frontmatter":{"path":"/part-1/4-defining-start-conditions","title":"Defining start conditions for the container"}}},{"node":{"id":"a3fe4972-edce-5bc7-9eb5-b355fac1ebf8","frontmatter":{"path":"/part-2/1-migrating-to-docker-compose","title":"Migrating to docker compose"}}},{"node":{"id":"3447594d-f3e4-56a2-8d83-12bf7ff5f3a4","frontmatter":{"path":"/part-3/1-using-non-root-user","title":"Using a non-root user"}}},{"node":{"id":"bc9490fd-c9f8-5a6a-8370-2ef946d4e3fa","frontmatter":{"path":"/part-3/4-extras","title":"Extras"}}},{"node":{"id":"67016067-426f-51cc-8ea0-3e16da657b13","frontmatter":{"path":"/part-3/3-multi-host-environments","title":"Multi-host environments"}}}]}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}